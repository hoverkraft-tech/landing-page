---
import Layout from '~/layouts/PageLayout.astro';
import HeroText from '~/components/widgets/HeroText.astro';
import Note from '~/components/widgets/Note.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';

import MaturityAssessmentWidget from '~/components/maturity-assessment/MaturityAssessment.tsx';
import { getMaturityAssessmentAxes } from '~/data/maturity-assessment';
import { getLangFromUrl, useTranslatedPath } from '~/i18n/utils';

const lang = getLangFromUrl(Astro.url);
const translatePath = useTranslatedPath(lang);

const metadata = {
  title: 'Radar de maturité Platform Engineering - Hoverkraft',
  description:
    "Auto-évaluez la maturité de votre platform engineering en 5 minutes sur 7 axes. Visualisez votre profil et identifiez vos leviers d'amélioration.",
  openGraph: {
    images: [
      {
        url: '~/assets/images/pages/maturity-assessment/og-preview-fr.jpeg',
        width: 1424,
        height: 752,
      },
    ],
  },
};

const axes = getMaturityAssessmentAxes('fr');
const formId = 'maturity-assessment-fr';
const strings = {
  currentProfileTitle: 'Votre profil actuel',
  scoreLabel: 'Score global',
  progressLabel: 'Avancement',
  printTagline: 'Radar de maturité',
  printTitle: 'Évaluation de maturité Platform Engineering',
  printAnswersTitle: 'Réponses',
  printInterpretationTitle: 'Interprétation',
  printFooterUrl: 'https://hoverkraft.tech',
  shareLabel: 'Partager',
  sharePrintLabel: 'Imprimer',
  shareCopyLabel: 'Copier le lien',
  shareCopySuccessLabel: 'Lien copié',
  shareMailLabel: 'Partager par email',
  shareMailSubject: 'Radar de maturité Platform Engineering - évaluation',
  shareTextWithInterpretation:
    'Mon score de maturité Platform Engineering : {score} ({interpretation}) - Diagnostic proposé par Hoverkraft',
  shareTextWithoutInterpretation:
    'Mon score de maturité Platform Engineering : {score} - Diagnostic proposé par Hoverkraft',
  shareMailBodyWithInterpretation:
    "Bonjour,\\n\\nVoici l'évaluation de maturité Platform Engineering :\\n- Score : {score}\\n- Niveau : {interpretation}\\n\\nLien du diagnostic (inclut mes réponses) :\\n{url}\\n\\nDiagnostic proposé par Hoverkraft — https://hoverkraft.tech\\n",
  shareMailBodyWithoutInterpretation:
    "Bonjour,\\n\\nVoici l'évaluation de maturité Platform Engineering :\\n- Score : {score}\\n\\nLien du diagnostic (inclut mes réponses) :\\n{url}\\n\\nDiagnostic proposé par Hoverkraft — https://hoverkraft.tech\\n",
  shareLinkedInLabel: 'Partager sur LinkedIn',
  shareBlueskyLabel: 'Partager sur Bluesky',
  resetLabel: 'Réinitialiser',
  editLabel: 'Modifier',
  levelPrefix: 'Niveau',
  interpretation: {
    initial: 'Initial',
    repeatable: 'Géré',
    defined: 'Défini',
    managed: 'Quantifié',
    optimizing: 'Optimisé',
  },
};
---

<Layout metadata={metadata}>
  <div data-maturity-assessment-hero>
    <HeroText
      tagline="Radar de maturité"
      title="Évaluation de maturité Platform Engineering"
      subtitle="En 5 minutes, positionnez votre équipe sur 7 axes clés (DevX, environnements, CI/CD, conteneurs, observabilité, sécurité, amélioration continue) et visualisez votre profil."
      callToAction={{
        variant: 'primary',
        text: 'Démarrer l’auto-évaluation',
        href: '#auto-evaluation',
      }}
      callToAction2={{
        text: 'Nous contacter',
        href: translatePath('/contact#form'),
      }}
    />
  </div>

  <div data-maturity-assessment-no-print>
    <Note
      title="Pourquoi cette auto-évaluation ?"
      description="Le Platform Engineering n’est efficace que s’il est mesurable. Ce radar vous aide à objectiver votre point de départ, aligner les parties prenantes, et prioriser des actions à impact (DORA, SPACE, sécurité)."
    />
  </div>

  <section id="auto-evaluation" class="relative py-12 md:py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <header class="mb-8 text-center" data-maturity-assessment-intro>
        <h2 class="text-3xl md:text-4xl font-bold tracking-tighter text-heading">Votre auto-évaluation</h2>
        <p class="mt-3 text-lg text-muted">
          Sélectionnez un niveau (1 à 5) pour chaque critère. Le radar se met à jour automatiquement.
        </p>
      </header>

      <style is:inline>
        @media print {
          /* Print should contain only the report itself */
          #header,
          body > footer {
            display: none !important;
          }

          [data-maturity-assessment-hero] {
            display: none !important;
          }

          [data-maturity-assessment-intro] {
            display: none !important;
          }

          [data-maturity-assessment-no-print] {
            display: none !important;
          }
        }
      </style>

      <MaturityAssessmentWidget
        id={formId}
        axes={axes}
        strings={strings}
        pageUrl={Astro.url.toString()}
        lang={lang}
        client:load
      />

      <div class="mt-8 w-full text-sm text-muted" data-maturity-assessment-no-print>
        <p class="font-semibold text-heading">Interprétation du résultat (CMM)</p>
        <p class="mt-2">
          CMM est un modèle de bonnes pratiques qui repose sur une amélioration progressive des processus de
          développement informatique de l'entreprise.
        </p>
        <ul class="mt-3 space-y-2">
          <li>
            <span class="font-semibold text-heading">Niveau « Initial »</span> où les processus sont non répétables et non
            maîtrisés.
          </li>
          <li>
            <span class="font-semibold text-heading">Niveau « Géré »</span> où les processus sont planifiés et répétables.
            Il traduit la mise en oeuvre effective de pratiques de base au niveau des projets mais sans harmonisation au niveau
            de l'organisation (par exemple chaque projet gère différemment sa planification, ses configurations...); il s'adresse
            essentiellement aux Chefs de Projet.
          </li>
          <li>
            <span class="font-semibold text-heading">Niveau « Défini »</span> où les processus sont organisés, réactifs et
            maîtrisés. Il traduit le déploiement harmonisé de pratiques définies au niveau de l'organisation ; il s'adresse
            à toute la population et met l'accent sur l'engineering produit et l'organisation centrale.
          </li>
          <li>
            <span class="font-semibold text-heading">Niveau « Quantifié »</span> où les processus sont mesurés et contrôles.
            Il traduit une gestion quantitative des processus, basée sur des analyses statistiques (les performances de l'organisation
            sont prévisibles).
          </li>
          <li>
            <span class="font-semibold text-heading">Niveau « Optimisé »</span> où l'organisation est en amélioration continue.
            Il traduit la maturité de l'organisation où veille technologique et amélioration continue concourent à l'excellence
            du livrable.
          </li>
        </ul>
      </div>
    </div>
  </section>

  <div data-maturity-assessment-no-print>
    <CallToAction
      actions={[
        { variant: 'primary', text: 'Réserver un débrief (30 min)', href: translatePath('/contact#form') },
        { text: 'Voir nos offres', href: translatePath('/offers') },
      ]}
    >
      <Fragment slot="title">Envie d’aller plus loin ?</Fragment>
      <Fragment slot="subtitle">
        Ce radar est une première étape. Discutons de vos résultats pour comprendre votre contexte et identifier vos
        leviers d’action prioritaires.
      </Fragment>
    </CallToAction>
  </div>
</Layout>
