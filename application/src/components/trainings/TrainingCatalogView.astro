---
/**
 * Reusable component for training catalog page
 */
import type { TrainingCourse } from '~/data/trainings';
import type { SupportedLanguage } from '~/i18n/ui';
import { useTranslations, useTranslatedPath } from '~/i18n/utils';
import Layout from '~/layouts/PageLayout.astro';
import Hero from '~/components/widgets/Hero.astro';
import Features2 from '~/components/widgets/Features2.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import Content from '~/components/widgets/Content.astro';

interface Props {
  courses: TrainingCourse[];
  lang: SupportedLanguage;
  metadata: {
    title: string;
    description: string;
  };
}

const { courses, lang, metadata } = Astro.props;
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);

const contactPath = translatePath('/contact');
const offersPath = translatePath('/offers');
const courseBasePath = translatePath('/trainings');

const HERO_IMAGE = '~/assets/images/programming-2.webp';
const PRINCIPLES_IMAGE = '~/assets/images/programming-1.webp';
const ARRANGEMENTS_IMAGE = '~/assets/images/programming-5.webp';

const PRINCIPLES_ICONS = ['tabler:school', 'tabler:user-star', 'tabler:refresh', 'tabler:adjustments'] as const;
const ARRANGEMENTS_ICONS = ['tabler:map-pin', 'tabler:coin', 'tabler:server', 'tabler:file-text'] as const;

const hero = {
  tagline: t('training.hero.tagline'),
  title: t('training.hero.title'),
  subtitle: t('training.hero.subtitle'),
  image: HERO_IMAGE,
};

const catalog = {
  title: t('training.catalog.title'),
  subtitle: t('training.catalog.subtitle'),
};

const principles = {
  title: t('training.principles.title'),
  items: PRINCIPLES_ICONS.map((icon, index) => {
    const titleKey = `training.principles.items.${index}.title` as const;
    const descriptionKey = `training.principles.items.${index}.description` as const;
    return {
      icon,
      // eslint-disable-next-line @typescript-eslint/no-explicit-any
      title: (t as any)(titleKey),
      // eslint-disable-next-line @typescript-eslint/no-explicit-any
      description: (t as any)(descriptionKey),
    };
  }),
  image: PRINCIPLES_IMAGE,
};

const arrangements = {
  title: t('training.arrangements.title'),
  items: ARRANGEMENTS_ICONS.map((icon, index) => {
    const titleKey = `training.arrangements.items.${index}.title` as const;
    const descriptionKey = `training.arrangements.items.${index}.description` as const;
    return {
      icon,
      // eslint-disable-next-line @typescript-eslint/no-explicit-any
      title: (t as any)(titleKey),
      // eslint-disable-next-line @typescript-eslint/no-explicit-any
      description: (t as any)(descriptionKey),
    };
  }),
  image: ARRANGEMENTS_IMAGE,
};

const cta = {
  title: t('training.cta.title'),
  subtitle: t('training.cta.subtitle'),
  primaryAction: t('training.cta.primaryAction'),
  secondaryAction: t('training.cta.secondaryAction'),
};
---

<Layout metadata={metadata}>
  <Hero
    tagline={hero.tagline}
    actions={[
      { variant: 'primary', text: cta.primaryAction, href: `${contactPath}#form` },
      { text: t('button.view-offers'), href: offersPath },
    ]}
    image={{
      src: hero.image,
      alt: hero.tagline,
    }}
  >
    <Fragment slot="title">{hero.title}</Fragment>
    <Fragment slot="subtitle">{hero.subtitle}</Fragment>
  </Hero>

  <Features2
    title={catalog.title}
    subtitle={catalog.subtitle}
    columns={3}
    items={courses.map((course) => ({
      title: course.title,
      description: course.description,
      icon: course.icon,
      callToAction: {
        text: t('button.learn-more'),
        href: `${courseBasePath}/${course.slug}`,
      },
    }))}
  />

  <Content
    isReversed
    title={principles.title}
    items={principles.items}
    image={{
      src: principles.image,
      alt: principles.title,
    }}
  />

  <Content
    isAfterContent
    title={arrangements.title}
    items={arrangements.items}
    image={{
      src: arrangements.image,
      alt: arrangements.title,
    }}
  />

  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: cta.primaryAction,
        href: `${contactPath}#form`,
      },
      {
        text: cta.secondaryAction,
        href: contactPath,
      },
    ]}
    title={cta.title}
    subtitle={cta.subtitle}
  />
</Layout>
